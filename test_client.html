<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
      <title>Socket IO</title>
  </head>
  <body>
    <script src="http://localhost:3001/../bower_components/socket.io-client/socket.io.js"></script>

    <script>

      function randInt(a, b){
        return parseInt(Math.floor(Math.random() * (b - a) + b));
      }

      var socket = io.connect('http://localhost:3000'),
          userName = 'Ghof_' + randInt(0, 10000),
          turn_id,
          tournamentID = 142857;

      socket.on('connect',function(){

        // Client has connected
        console.log("Conectado: " + userName);

        // Signing signal
        socket.emit('signin', {
          user_name: userName,
          tournament_id: tournamentID,
          user_role: 'player'
        });
      });

      socket.on('ready', function(data){

        // Client is about to move
        console.log("About to move");

        socket.emit('play', {
          turn_id: data.turn_id,
          tournament_id: tournamentID, // TODO: Remember to notify my students of change
          game_id: data.game_id,
          movement: 20  // TODO: position --> movement, remember to notify my students of change
        });
      });

      socket.on('finish', function(data){

        // The game has finished
        console.log("Game " + data.game_id + " has finished");

        // Inform my students that there is no rematch attribute
        console.log("Ready to play again!");

        // Start again!

        socket.emit('player_ready', { // TODO: remember to notify my students
          tournament_id: tournamentID, // TODO: Remember to notify my students of change
          game_id: data.game_id,
          turn_id: data.turn_id // TODO: player_id --> turn_id, remember to notify my students of change
        });

      });

    </script>
  </body>
</html>